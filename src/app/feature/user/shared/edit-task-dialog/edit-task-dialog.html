<h2>Update Task</h2>
<mat-dialog-content class="mat-typography">
  <form [formGroup]="storyForm" class="dialog-form">

      <mat-form-field appearance="outline" class="mb">
        <mat-label>Title</mat-label>
        <input matInput formControlName="title">
      </mat-form-field>
       @if (getControl('title')?.invalid && (getControl('title')?.dirty || getControl('title')?.touched)) {
        @if (getControl('title')?.hasError('required')) {
        <mat-error class="error-message">Title is required.</mat-error>
        } @else if (getControl('title')?.hasError('maxlength')) {
        <mat-error class="error-message">Title is too long.</mat-error>
        }
        }

      <mat-form-field appearance="outline">
        <mat-label>Description</mat-label>
        <textarea matInput rows="3" formControlName="description"></textarea>
      </mat-form-field>
      @if (getControl('description')?.invalid && (getControl('description')?.dirty ||
        getControl('description')?.touched)) {
        <mat-error class="error-message">Description is required.</mat-error>
        }

      <mat-form-field appearance="outline">
        <mat-label>Acceptance Criteria</mat-label>
        <textarea matInput rows="3" formControlName="acceptanceCriteria"></textarea>
      </mat-form-field>
      @if (getControl('acceptanceCriteria')?.invalid && (getControl('acceptanceCriteria')?.dirty ||
        getControl('acceptanceCriteria')?.touched)) {
        <mat-error class="error-message">Acceptance Criteria is required.</mat-error>
        }

      <mat-form-field appearance="outline">
        <mat-label>Story Points</mat-label>
        <input matInput type="number" formControlName="storyPoints">
      </mat-form-field>
       @if (getControl('storyPoints')?.invalid && (getControl('storyPoints')?.dirty ||
        getControl('storyPoints')?.touched)) {
        @if (getControl('storyPoints')?.hasError('required')) {
        <mat-error class="error-message">Estimate is required.</mat-error>
        } @else if (getControl('storyPoints')?.hasError('min')) {
        <mat-error class="error-message">Story points canâ€™t be negative.</mat-error>
        }
        }

      <mat-form-field appearance="outline">
        <mat-label>Priority</mat-label>
        <mat-select formControlName="priority">
          @for (p of priorities; track p) {
            <mat-option [value]="p">{{ p }}</mat-option>
            }
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Status</mat-label>
        <mat-select formControlName="status">
          <mat-option value="New">New</mat-option>
          <mat-option value="In-Progress">In-Progress</mat-option>
          <mat-option value="Completed">Completed</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Assigned To</mat-label>
        <input matInput formControlName="assignedTo" readonly>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Completion Date</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="completionDate">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>

    </form>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button matButton mat-dialog-close>Cancel</button>
  <button matButton [mat-dialog-close]="true" [disabled]="storyForm.invalid" (click)="save()">Update</button>
</mat-dialog-actions>
